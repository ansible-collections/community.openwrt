# Copyright (c) 2026, Alexei Znamensky (@russoz)
# GNU General Public License v3.0+ (see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt)
# SPDX-License-Identifier: GPL-3.0-or-later

---
- name: "Gather system facts"
  community.openwrt.setup:
  register: setup_result

- name: Pring facts
  ansible.builtin.debug:
    var: setup_result

- name: Assert setup gathered facts
  ansible.builtin.assert:
    that:
      - setup_result is succeeded
      - setup_result.ansible_facts is defined

- name: Assert ansible_os_family is defined
  ansible.builtin.assert:
    that:
      - setup_result.ansible_facts.ansible_os_family is defined

- name: Assert date/time facts
  vars:
    dt: "{{ setup_result.ansible_facts.ansible_date_time | default({}) }}"
  ansible.builtin.assert:
    that:
      - dt is defined
      - dt.date == dt.year + "-" + dt.month + "-" + dt.day
