

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Community OpenWrt Migration Guide &mdash; Community.OpenWrt Collection  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=41de9001" />
      <link rel="stylesheet" type="text/css" href="../_static/css/ansible.css?v=b54c304f" />
      <link rel="stylesheet" type="text/css" href="../_static/antsibull-minimal.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/rtd-ethical-ads.css?v=289b023e" />

  
    <link rel="shortcut icon" href="../_static/images/Ansible-Mark-RGB_Black.png"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7f41d439"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OpenWrt 25.x Package Manager changes" href="migration_apk_guide.html" />
    <link rel="prev" title="Community OpenWrt User Guide" href="user_guide.html" /><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->




</head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
    <li><a href="https://forum.ansible.com/" target="_blank">Ansible community forum</a></li>
    <li><a href="https://docs.ansible.com/" target="_blank">Documentation</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="https://ansible-collections.github.io/community.openwrt/branch/main/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/Ansible-Mark-RGB_White.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">Community.OpenWrt Collection Docs</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Community.OpenWrt Collection
          </a><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    
  
</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <label class="sr-only" for="q">Search docs:</label>
    <input type="text" class="st-default-search-input" id="q" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">Community OpenWrt User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Community OpenWrt Migration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-differences">Key Differences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#no-support-for-standard-ansible-modules">No Support for Standard Ansible Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#namespace">Namespace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#migration-steps">Migration Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-install-the-collection">Step 1: Install the Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-update-role-references">Step 2: Update Role References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-add-module-namespaces">Step 3: Add Module Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-handler-references">Step 4: Handler References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#complete-example">Complete Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-your-migration">Testing Your Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#collection-not-found">Collection Not Found</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-behavior-differences">Module Behavior Differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migration_apk_guide.html">OpenWrt 25.x Package Manager changes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mod_dev_guide.html">Community OpenWrt Module Developer Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apk_module.html">community.openwrt.apk module – Manage packages with apk on OpenWrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_module.html">community.openwrt.command module – Execute commands on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copy_module.html">community.openwrt.copy module – Copy files to remote OpenWrt devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_module.html">community.openwrt.file module – Manage files and file properties on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lineinfile_module.html">community.openwrt.lineinfile module – Manage lines in text files on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nohup_module.html">community.openwrt.nohup module – Starts a command in background and returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../opkg_module.html">community.openwrt.opkg module – Manage packages with opkg on OpenWrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ping_module.html">community.openwrt.ping module – Verify ability to communicate with OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../service_module.html">community.openwrt.service module – Manage services on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_module.html">community.openwrt.setup module – Gather facts about OpenWrt systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slurp_module.html">community.openwrt.slurp module – Slurps a file from remote OpenWrt nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stat_module.html">community.openwrt.stat module – Retrieve file or file system status on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sysctl_module.html">community.openwrt.sysctl module – Manage sysctl entries on OpenWrt targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uci_module.html">community.openwrt.uci module – Controls OpenWrt UCI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrapper_module.html">community.openwrt.wrapper module – Internal wrapper module for OpenWrt shell-based modules</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Community.OpenWrt Collection</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Community OpenWrt Migration Guide</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

  
           <div itemprop="articleBody">
             
  <section id="community-openwrt-migration-guide">
<span id="ansible-collections-community-openwrt-docsite-migration-guide"></span><h1>Community OpenWrt Migration Guide<a class="headerlink" href="#community-openwrt-migration-guide" title="Link to this heading"></a></h1>
<p>This guide provides the information needed for users migrating from <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> role
to the <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> collection.</p>
<p>If you are new to <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> and not migrating from <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code>,
you should start with the <a class="reference internal" href="user_guide.html#ansible-collections-community-openwrt-docsite-user-guide"><span class="std std-ref">Community OpenWrt User Guide</span></a> instead.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> collection builds upon the foundation of the <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code>
Ansible role, which was maintained by Markus Weippert until 2022. While the core functionality
remains similar, there are important changes in structure and usage patterns that you will need
to address when migrating your playbooks.</p>
<p>The good news is that both projects share the same approach: they enable you to manage OpenWrt
devices without requiring Python on the target systems. All modules are implemented as shell
scripts, making them compatible with resource-constrained devices. While the underlying code
is largely the same, the collection now provides proper documentation for each module, accessible
via <code class="docutils literal notranslate"><span class="pre">ansible-doc</span></code> or the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/openwrt/">collection documentation site</a>.</p>
</section>
<section id="key-differences">
<h2>Key Differences<a class="headerlink" href="#key-differences" title="Link to this heading"></a></h2>
<section id="structure">
<h3>Structure<a class="headerlink" href="#structure" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> was an Ansible role that you included in your playbooks.
It provided modules and handlers as part of the role.</p>
<p><code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> is a full Ansible collection with a defined namespace.
It provides:</p>
<ul class="simple">
<li><p>Multiple modules (<code class="docutils literal notranslate"><span class="pre">community.openwrt.opkg</span></code>, <code class="docutils literal notranslate"><span class="pre">community.openwrt.uci</span></code>, etc.)</p></li>
<li><p>Multiple roles (<code class="docutils literal notranslate"><span class="pre">community.openwrt.init</span></code>, <code class="docutils literal notranslate"><span class="pre">community.openwrt.common</span></code>)</p></li>
<li><p>Handlers and plugins organized in a standard collection structure</p></li>
</ul>
</section>
<section id="no-support-for-standard-ansible-modules">
<h3>No Support for Standard Ansible Modules<a class="headerlink" href="#no-support-for-standard-ansible-modules" title="Link to this heading"></a></h3>
<p>Migrated playbooks MUST only use modules in the <code class="docutils literal notranslate"><span class="pre">community.openwrt.*</span></code> namespace.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> <a class="reference external" href="https://en.wikipedia.org/wiki/Monkey_patch">monkey patched</a> Ansible,
many of the standard Ansible modules continued to work as normal on OpenWrt devices while not
requiring Python to be installed on them. This collection instead uses shell scripts to create new
modules without any Python requirement. If you are migrating playbooks that utilize standard Ansible
modules, you should be aware that not all modules have been ported or have an equivalent replacment.</p>
<p>This would include any standard module in the <code class="docutils literal notranslate"><span class="pre">ansible.builtin.*</span></code> collection such as <code class="docutils literal notranslate"><span class="pre">fetch</span></code>,
<code class="docutils literal notranslate"><span class="pre">lineinfile</span></code>, <code class="docutils literal notranslate"><span class="pre">template</span></code>, etc. These modules will typically fail with an error such as:
<code class="docutils literal notranslate"><span class="pre">Task</span> <span class="pre">failed:</span> <span class="pre">Action</span> <span class="pre">failed:</span> <span class="pre">The</span> <span class="pre">module</span> <span class="pre">interpreter</span> <span class="pre">'/usr/bin/python3'</span> <span class="pre">was</span> <span class="pre">not</span> <span class="pre">found</span></code></p>
</section>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-galaxy<span class="w"> </span>install<span class="w"> </span>gekmihesg.openwrt
</pre></div>
</div>
</td>
<td><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>community.openwrt
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading"></a></h3>
<p>Both <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> and <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> require you to include an initialization
role before using their modules and handlers.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openwrt</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gekmihesg.openwrt</span>
</pre></div>
</div>
</td>
<td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routers</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">community.openwrt.init</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The initialization role sets up the necessary environment, installs recommended packages,
configures variables, and registers handlers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> role required all target hosts to be members of an
<code class="docutils literal notranslate"><span class="pre">openwrt</span></code> group. The <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> collection has no such requirement - you can
use any group name or host pattern you prefer.</p>
</div>
</section>
<section id="namespace">
<h3>Namespace<a class="headerlink" href="#namespace" title="Link to this heading"></a></h3>
<p>All modules and roles now use the <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> namespace prefix.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install package</span>
<span class="w">  </span><span class="nt">opkg</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
</td>
<td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install package</span>
<span class="w">  </span><span class="nt">community.openwrt.opkg</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">    </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="migration-steps">
<h2>Migration Steps<a class="headerlink" href="#migration-steps" title="Link to this heading"></a></h2>
<section id="step-1-install-the-collection">
<h3>Step 1: Install the Collection<a class="headerlink" href="#step-1-install-the-collection" title="Link to this heading"></a></h3>
<p>First, install the <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> collection:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>community.openwrt
</pre></div>
</div>
<p>You can optionally add it to your <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">collections</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">community.openwrt</span>
</pre></div>
</div>
</section>
<section id="step-2-update-role-references">
<h3>Step 2: Update Role References<a class="headerlink" href="#step-2-update-role-references" title="Link to this heading"></a></h3>
<p>Replace references to the <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> role with <code class="docutils literal notranslate"><span class="pre">community.openwrt.init</span></code>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openwrt</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gekmihesg.openwrt</span>
</pre></div>
</div>
</td>
<td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routers</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">community.openwrt.init</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-add-module-namespaces">
<h3>Step 3: Add Module Namespaces<a class="headerlink" href="#step-3-add-module-namespaces" title="Link to this heading"></a></h3>
<p>Update all module calls to include the <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code> namespace prefix.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gather facts</span>
<span class="w">    </span><span class="nt">setup</span><span class="p">:</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install package</span>
<span class="w">    </span><span class="nt">opkg</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure UCI</span>
<span class="w">    </span><span class="nt">uci</span><span class="p">:</span>
<span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set</span>
<span class="w">      </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system.@system[0].hostname</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myrouter</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy file</span>
<span class="w">    </span><span class="nt">copy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/file</span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/config/custom</span>
</pre></div>
</div>
</td>
<td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gather facts</span>
<span class="w">    </span><span class="nt">community.openwrt.setup</span><span class="p">:</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install package</span>
<span class="w">    </span><span class="nt">community.openwrt.opkg</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure UCI</span>
<span class="w">    </span><span class="nt">community.openwrt.uci</span><span class="p">:</span>
<span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set</span>
<span class="w">      </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system.@system[0].hostname</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myrouter</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Copy file</span>
<span class="w">    </span><span class="nt">community.openwrt.copy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/file</span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/config/custom</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="step-4-handler-references">
<h3>Step 4: Handler References<a class="headerlink" href="#step-4-handler-references" title="Link to this heading"></a></h3>
<p>Handlers references remain the same, just make sure you have included the <code class="docutils literal notranslate"><span class="pre">community.openwrt.init</span></code> role
for them to be available.</p>
<div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Configure wireless</span>
<span class="w">  </span><span class="nt">community.openwrt.uci</span><span class="p">:</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set</span>
<span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wireless.radio0.channel</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6&quot;</span>
<span class="w">  </span><span class="nt">notify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reload wifi</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The names of some handlers that were entirely lower case have been capitalized.</p>
</div>
</section>
</section>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Link to this heading"></a></h2>
<p>Most variables remain compatible between <code class="docutils literal notranslate"><span class="pre">gekmihesg.openwrt</span></code> and <code class="docutils literal notranslate"><span class="pre">community.openwrt</span></code>.
The collection uses the same variable names:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">openwrt_scp_if_ssh</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openwrt_remote_tmp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openwrt_install_recommended_packages</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openwrt_wait_for_connection</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">openwrt_wait_for_connection_timeout</span></code></p></li>
</ul>
<p>These variables continue to work as before, so your existing variable definitions
in inventory, group_vars, or host_vars should not require changes. They can also be
set when including the initialization role, as shown in the complete example below.</p>
</section>
<section id="complete-example">
<h2>Complete Example<a class="headerlink" href="#complete-example" title="Link to this heading"></a></h2>
<p>Here is a complete before-and-after example to illustrate the migration:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>gekmihesg.openwrt</p></th>
<th class="head"><p>community.openwrt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openwrt</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gekmihesg.openwrt</span>
<span class="w">      </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">        </span><span class="nt">openwrt_install_recommended_packages</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gather facts</span>
<span class="w">      </span><span class="nt">setup</span><span class="p">:</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install packages</span>
<span class="w">      </span><span class="nt">opkg</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">      </span><span class="nt">loop</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci-ssl</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set hostname</span>
<span class="w">      </span><span class="nt">uci</span><span class="p">:</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system.@system[0].hostname</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myrouter</span>
<span class="w">      </span><span class="nt">notify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reload network</span>
</pre></div>
</div>
</td>
<td><div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">routers</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">role</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">community.openwrt.init</span>
<span class="w">      </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">        </span><span class="nt">openwrt_install_recommended_packages</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gather facts</span>
<span class="w">      </span><span class="nt">community.openwrt.setup</span><span class="p">:</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install packages</span>
<span class="w">      </span><span class="nt">community.openwrt.opkg</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
<span class="w">      </span><span class="nt">loop</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">luci-ssl</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set hostname</span>
<span class="w">      </span><span class="nt">community.openwrt.uci</span><span class="p">:</span>
<span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">set</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system.@system[0].hostname</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myrouter</span>
<span class="w">      </span><span class="nt">notify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Reload network</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="testing-your-migration">
<h2>Testing Your Migration<a class="headerlink" href="#testing-your-migration" title="Link to this heading"></a></h2>
<p>After updating your playbooks:</p>
<ol class="arabic simple">
<li><p><strong>Start small</strong>: Test with a single device or a small group first</p></li>
<li><p><strong>Run in check mode</strong>: Use <code class="docutils literal notranslate"><span class="pre">--check</span></code> to see what would change without making changes</p></li>
<li><p><strong>Verify handlers</strong>: Ensure handlers are properly notified and executed</p></li>
<li><p><strong>Check facts</strong>: Verify that <code class="docutils literal notranslate"><span class="pre">community.openwrt.setup</span></code> returns the expected facts</p></li>
<li><p><strong>Monitor logs</strong>: Review task output for any unexpected warnings or errors</p></li>
</ol>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<section id="collection-not-found">
<h3>Collection Not Found<a class="headerlink" href="#collection-not-found" title="Link to this heading"></a></h3>
<p>If you see errors like <code class="docutils literal notranslate"><span class="pre">could</span> <span class="pre">not</span> <span class="pre">resolve</span> <span class="pre">module/action</span> <span class="pre">'community.openwrt.opkg'</span></code>:</p>
<ul class="simple">
<li><p>Verify the collection is installed: <code class="docutils literal notranslate"><span class="pre">ansible-galaxy</span> <span class="pre">collection</span> <span class="pre">list</span></code></p></li>
<li><p>Check you are using the correct namespace prefix</p></li>
<li><p>Ensure your Ansible version meets the minimum requirements (see the collection README)</p></li>
</ul>
</section>
<section id="module-behavior-differences">
<h3>Module Behavior Differences<a class="headerlink" href="#module-behavior-differences" title="Link to this heading"></a></h3>
<p>While the collection maintains compatibility with the original role’s functionality,
some edge cases may behave slightly differently. If you encounter unexpected behavior:</p>
<ul class="simple">
<li><p>Check the module documentation: <code class="docutils literal notranslate"><span class="pre">ansible-doc</span> <span class="pre">community.openwrt.&lt;module_name&gt;</span></code></p></li>
<li><p>Review the <a class="reference external" href="https://github.com/ansible-collections/community.openwrt/issues">collection’s issue tracker on GitHub</a></p></li>
</ul>
</section>
</section>
<section id="getting-help">
<h2>Getting Help<a class="headerlink" href="#getting-help" title="Link to this heading"></a></h2>
<p>If you encounter issues during migration:</p>
<ul class="simple">
<li><p>Check the <a class="reference internal" href="user_guide.html#ansible-collections-community-openwrt-docsite-user-guide"><span class="std std-ref">Community OpenWrt User Guide</span></a></p></li>
<li><p>Review the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/openwrt/">collection documentation</a></p></li>
<li><p>Join the <a class="reference external" href="https://forum.ansible.com/">Ansible forum</a> and use the <code class="docutils literal notranslate"><span class="pre">community-openwrt</span></code> tag</p></li>
<li><p>Visit the <a class="reference external" href="https://github.com/ansible-collections/community.openwrt">GitHub repository</a></p></li>
<li><p>Consider opening an issue if you believe you have found a compatibility problem</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.3.0.</span></p>
</div>
</section>
</section>


           </div>
          </div>
          

<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="user_guide.html" class="btn btn-neutral float-left" title="Community OpenWrt User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="migration_apk_guide.html" class="btn btn-neutral float-right" title="OpenWrt 25.x Package Manager changes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Community.OpenWrt Contributors.</p>
  </div>

  
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->

</body>
</html>